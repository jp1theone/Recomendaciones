<!doctype html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Sistema de Recomendación EPICS{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    {% block extra_head %}{% endblock %}
</head>
<body>
    <div class="app-layout">
        {% if g.user %}
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="data:image/png;base64,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" alt="Logo EPICS USMP" class="logo-sidebar">
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="{{ url_for('dashboard') }}" class="{% if request.endpoint == 'dashboard' %}active{% endif %}">Inicio</a></li>
                    <li><a href="{{ url_for('profile') }}" class="{% if request.endpoint == 'profile' %}active{% endif %}">Mi Perfil</a></li>
                    <li><a href="{{ url_for('jobs_list') }}" class="{% if request.endpoint == 'jobs_list' %}active{% endif %}">Oportunidades</a></li>
                    <li><a href="{{ url_for('recommendations') }}" class="{% if request.endpoint == 'recommendations' %}active{% endif %}">Mis Recomendaciones</a></li>
                    <li><a href="{{ url_for('add_job') }}" class="{% if request.endpoint == 'add_job' %}active{% endif %}">Añadir Oferta</a></li> 
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="{{ url_for('logout') }}" id="logout-link">Cerrar Sesión</a>
                 <p class="user-info">
                    {{ session.nombre_completo if session.nombre_completo else (g.user.nombre_completo if g.user else 'Usuario') }}
                </p>
            </div>
        </aside>
        {% endif %}

        <div class="main-content-wrapper {% if g.user %}with-sidebar{% else %}login-register-view{% endif %}">
            {% if g.user %}
            <header class="main-header">
                <span class="header-title">{% block header_title %}Bienvenido{% endblock %}</span>
                <div class="header-user-info">
                    {% if request.endpoint == 'profile' %}
                         <div class="profile-completeness" id="profile-completeness-indicator">Perfil: --%</div>
                    {% endif %}
                    <div class="user-avatar" id="user-initials">
                        {# Lógica para iniciales, mejorada en el script de profile_form.html #}
                        {{ (session.nombre_completo[0] if session.nombre_completo and session.nombre_completo|length > 0 else (g.user.nombre_completo[0] if g.user and g.user.nombre_completo and g.user.nombre_completo|length > 0 else '?'))|upper }}
                    </div>
                </div>
            </header>
            {% endif %}

            <main class="content-area {% if not g.user %}no-header-padding{% endif %}">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        <div class="flash-messages">
                            {% for category, message in messages %}
                                <div class="alert alert-{{ category }}">{{ message }}</div>
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endwith %}
                {% block content %}{% endblock %}
            </main>

            {% if g.user %}
            <footer class="main-footer-content">
                <p>&copy; {{ now.year }} EPICS USMP - Proyecto de Recomendación</p>
            </footer>
            {% endif %}
        </div>
    </div>
    {% block scripts %}{% endblock %}
</body>
</html>